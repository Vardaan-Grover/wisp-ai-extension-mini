async function dmPageFlow() { const e = window.location.pathname.split("/")[3], a = await getUsernameFromDmId(e), s = await getPersonalizedScript(e); if (s) { const t = calculateRandomNumber(1e3, 3e3); await delay(3e3); const n = document.querySelector('div[aria-label="Message"]'); if (n) { const i = calculateRandomNumber(3e3, 5e3), o = n.getBoundingClientRect(), m = o.x + o.width / 2, r = o.y + o.height / 2; await delay(i), chrome.runtime.sendMessage({ message: "click_element", x: m, y: r }), await delay(t), chrome.runtime.sendMessage({ message: "type_text", text: s }, (async s => { if ("success" === s.message) { const s = calculateRandomNumber(4500, 7e3), t = Array.from(document.querySelectorAll('div[role="button"]')).filter((e => "send" === e.textContent.trim().toLowerCase()))[0]; if (t) { const n = t.getBoundingClientRect(), i = n.x + n.width / 2, o = n.y + n.height / 2; await delay(s), chrome.runtime.sendMessage({ message: "click_element", x: i, y: o }), chrome.runtime.sendMessage({ message: "update_username_sent_status_true_firestore", username: a }), decideNextAction(e) } else updateCampaignInfoMessageForUsername(e, a, "Seems like account has disabled direct messages or invite has already been sent.") } else updateCampaignInfoMessageForUsername(e, a, "Something went wrong while typing text") })) } else updateCampaignInfoMessageForUsername(e, a, "Seems like account has disabled direct messages or invite has already been sent.") } else updateCampaignInfoMessageForUsername(e, a, "Could not find personalized script for this username") } function updateCampaignInfoMessageForUsername(e, a, s) { chrome.runtime.sendMessage({ message: "update_campaign_info_message_for_username", username: a, content: s }, (a => { "success" === a.message && decideNextAction(e) })) } function decideNextAction(e) { chrome.runtime.sendMessage({ message: "dm_sent", dmId: e }, (async e => { const a = calculateRandomNumber(5e3, 6500); await delay(a); const s = await getUnsentUsername(); s && "dm_limit_reached" !== e.message || window.close(), "continue" === e.message ? window.location.assign(`https://www.instagram.com/${s}/`) : "threshold_hit" === e.message && window.location.assign("https://www.instagram.com/explore/") })) } dmPageFlow();